!function(i,t){"use strict";"object"==typeof exports?module.exports=t(require("jquery")):"function"==typeof define&&define.amd?define("gridster-coords",["jquery"],t):i.GridsterCoords=t(i.$||i.jQuery)}(this,function(i){"use strict";function t(t){return t[0]&&i.isPlainObject(t[0])?this.data=t[0]:this.el=t,this.isCoords=!0,this.coords={},this.init(),this}var s=t.prototype;return s.init=function(){this.set(),this.original_coords=this.get()},s.set=function(i,t){var s=this.el;if(s&&!i&&(this.data=s.offset(),this.data.width=s[0].scrollWidth,this.data.height=s[0].scrollHeight),s&&i&&!t){var e=s.offset();this.data.top=e.top,this.data.left=e.left}var o=this.data;return void 0===o.left&&(o.left=o.x1),void 0===o.top&&(o.top=o.y1),this.coords.x1=o.left,this.coords.y1=o.top,this.coords.x2=o.left+o.width,this.coords.y2=o.top+o.height,this.coords.cx=o.left+o.width/2,this.coords.cy=o.top+o.height/2,this.coords.width=o.width,this.coords.height=o.height,this.coords.el=s||!1,this},s.update=function(t){if(!t&&!this.el)return this;if(t){var s=i.extend({},this.data,t);return this.data=s,this.set(!0,!0)}return this.set(!0),this},s.get=function(){return this.coords},s.destroy=function(){this.el.removeData("coords"),delete this.el},i.fn.coords=function(){if(this.data("coords"))return this.data("coords");var i=new t(this);return this.data("coords",i),i},t}),function(i,t){"use strict";"object"==typeof exports?module.exports=t(require("jquery")):"function"==typeof define&&define.amd?define("gridster-collision",["jquery","gridster-coords"],t):i.GridsterCollision=t(i.$||i.jQuery,i.GridsterCoords)}(this,function(i,t){"use strict";var s={colliders_context:document.body,overlapping_region:"C"};function e(t,e,o){this.options=i.extend(s,o),this.$element=t,this.last_colliders=[],this.last_colliders_coords=[],this.set_colliders(e),this.init()}e.defaults=s;var o=e.prototype;return o.init=function(){this.find_collisions()},o.overlaps=function(i,t){var s=!1,e=!1;return(t.x1>=i.x1&&t.x1<=i.x2||t.x2>=i.x1&&t.x2<=i.x2||i.x1>=t.x1&&i.x2<=t.x2)&&(s=!0),(t.y1>=i.y1&&t.y1<=i.y2||t.y2>=i.y1&&t.y2<=i.y2||i.y1>=t.y1&&i.y2<=t.y2)&&(e=!0),s&&e},o.detect_overlapping_region=function(i,t){var s="",e="";return i.y1>t.cy&&i.y1<t.y2&&(s="N"),i.y2>t.y1&&i.y2<t.cy&&(s="S"),i.x1>t.cx&&i.x1<t.x2&&(e="W"),i.x2>t.x1&&i.x2<t.cx&&(e="E"),s+e||"C"},o.calculate_overlapped_area_coords=function(t,s){var e=Math.max(t.x1,s.x1),o=Math.max(t.y1,s.y1),r=Math.min(t.x2,s.x2),a=Math.min(t.y2,s.y2);return i({left:e,top:o,width:r-e,height:a-o}).coords().get()},o.calculate_overlapped_area=function(i){return i.width*i.height},o.manage_colliders_start_stop=function(t,s,e){for(var o=this.last_colliders_coords,r=0,a=o.length;r<a;r++)-1===i.inArray(o[r],t)&&s.call(this,o[r]);for(var n=0,_=t.length;n<_;n++)-1===i.inArray(t[n],o)&&e.call(this,t[n])},o.find_collisions=function(t){for(var s=this,e=this.options.overlapping_region,o=[],r=[],a=this.colliders||this.$colliders,n=a.length,_=s.$element.coords().update(t||!1).get();n--;){var h=s.$colliders?i(a[n]):a[n],d=h.isCoords?h:h.coords(),l=d.get();if(s.overlaps(_,l)){var c=s.detect_overlapping_region(_,l);if(c===e||"all"===e){var p=s.calculate_overlapped_area_coords(_,l),g=s.calculate_overlapped_area(p);if(0!==g){var u={area:g,area_coords:p,region:c,coords:l,player_coords:_,el:h};s.options.on_overlap&&s.options.on_overlap.call(this,u),o.push(d),r.push(u)}}}}return(s.options.on_overlap_stop||s.options.on_overlap_start)&&this.manage_colliders_start_stop(o,s.options.on_overlap_start,s.options.on_overlap_stop),this.last_colliders_coords=o,r},o.get_closest_colliders=function(i){var t=this.find_collisions(i);return t.sort(function(i,t){return"C"===i.region&&"C"===t.region?i.coords.y1<t.coords.y1||i.coords.x1<t.coords.x1?-1:1:(i.area,t.area,1)}),t},o.set_colliders=function(t){"string"==typeof t||t instanceof i?this.$colliders=i(t,this.options.colliders_context).not(this.$element):this.colliders=i(t)},i.fn.collision=function(i,t){return new e(this,i,t)},e}),function(i,t){"use strict";i.delay=function(i,t){var s=Array.prototype.slice.call(arguments,2);return setTimeout(function(){return i.apply(null,s)},t)},i.debounce=function(i,t,s){var e;return function(){var o=this,r=arguments;s&&!e&&i.apply(o,r),clearTimeout(e),e=setTimeout(function(){e=null,s||i.apply(o,r)},t)}},i.throttle=function(i,t){var s,e,o,r,a,n,_=debounce(function(){a=r=!1},t);return function(){s=this,e=arguments;return o||(o=setTimeout(function(){o=null,a&&i.apply(s,e),_()},t)),r?a=!0:n=i.apply(s,e),_(),r=!0,n}}}(window),function(i,t){"use strict";"object"==typeof exports?module.exports=t(require("jquery")):"function"==typeof define&&define.amd?define("gridster-draggable",["jquery"],t):i.GridsterDraggable=t(i.$||i.jQuery)}(this,function(i){"use strict";var t={items:"li",distance:1,limit:{width:!0,height:!1},offset_left:0,autoscroll:!0,ignore_dragging:["INPUT","TEXTAREA","SELECT","BUTTON"],handle:null,container_width:0,move_element:!0,helper:!1,remove_helper:!0},s=i(window),e={x:"left",y:"top"},o=!!("ontouchstart"in window),r=0,a=function(){return++r+""};function n(s,e){this.options=i.extend({},t,e),this.$document=i(document),this.$container=i(s),this.$scroll_container=this.options.scroll_container===window?i(window):this.$container.closest(this.options.scroll_container),this.is_dragging=!1,this.player_min_left=0+this.options.offset_left,this.player_min_top=0+this.options.offset_top,this.id=a(),this.ns=".gridster-draggable-"+this.id,this.init()}n.defaults=t;var _=n.prototype;return _.init=function(){var t=this.$container.css("position");this.calculate_dimensions(),this.$container.css("position","static"===t?"relative":t),this.disabled=!1,this.events(),s.bind(this.nsEvent("resize"),throttle(i.proxy(this.calculate_dimensions,this),200))},_.nsEvent=function(i){return(i||"")+this.ns},_.events=function(){this.pointer_events={start:this.nsEvent("touchstart")+" "+this.nsEvent("mousedown"),move:this.nsEvent("touchmove")+" "+this.nsEvent("mousemove"),end:this.nsEvent("touchend")+" "+this.nsEvent("mouseup")},this.$container.on(this.nsEvent("selectstart"),i.proxy(this.on_select_start,this)),this.$container.on(this.pointer_events.start,this.options.items,i.proxy(this.drag_handler,this)),this.$document.on(this.pointer_events.end,i.proxy(function(i){this.is_dragging=!1,this.disabled||(this.$document.off(this.pointer_events.move),this.drag_start&&this.on_dragstop(i))},this))},_.get_actual_pos=function(i){return i.position()},_.get_mouse_pos=function(i){if(i.originalEvent&&i.originalEvent.touches){var t=i.originalEvent;i=t.touches.length?t.touches[0]:t.changedTouches[0]}return{left:i.clientX,top:i.clientY}},_.get_offset=function(i){i.preventDefault();var t=this.get_mouse_pos(i),s=Math.round(t.left-this.mouse_init_pos.left),e=Math.round(t.top-this.mouse_init_pos.top),o=Math.round(this.el_init_offset.left+s-this.baseX+this.$scroll_container.scrollLeft()-this.scroll_container_offset_x),r=Math.round(this.el_init_offset.top+e-this.baseY+this.$scroll_container.scrollTop()-this.scroll_container_offset_y);return this.options.limit.width&&(o>this.player_max_left?o=this.player_max_left:o<this.player_min_left&&(o=this.player_min_left)),this.options.limit.height&&(r>this.player_max_top?r=this.player_max_top:r<this.player_min_top&&(r=this.player_min_top)),{position:{left:o,top:r},pointer:{left:t.left,top:t.top,diff_left:s+(this.$scroll_container.scrollLeft()-this.scroll_container_offset_x),diff_top:e+(this.$scroll_container.scrollTop()-this.scroll_container_offset_y)}}},_.get_drag_data=function(i){var t=this.get_offset(i);return t.$player=this.$player,t.$helper=this.helper?this.$helper:this.$player,t},_.set_limits=function(i){return i||(i=this.$container.width()),this.player_max_left=i-this.player_width-this.options.offset_left,this.player_max_top=this.options.container_height-this.player_height-this.options.offset_top,this.options.container_width=i,this},_.scroll_in=function(i,t){var s,o,r=e[i],a="scroll"+((s=r).charAt(0).toUpperCase()+s.slice(1)),n="x"===i,_=n?this.scroller_width:this.scroller_height;o=this.$scroll_container===window?n?this.$scroll_container.width():this.$scroll_container.height():n?this.$scroll_container[0].scrollWidth:this.$scroll_container[0].scrollHeight;var h,d=n?this.$player.width():this.$player.height(),l=this.$scroll_container[a](),c=l+_-50,p=l+50,g=l+t.pointer[r];return g>=c&&(h=l+30)<o-_+d&&(this.$scroll_container[a](h),this["scroll_offset_"+i]+=30),g<=p&&(h=l-30)>0&&(this.$scroll_container[a](h),this["scroll_offset_"+i]-=30),this},_.manage_scroll=function(i){this.scroll_in("x",i),this.scroll_in("y",i)},_.calculate_dimensions=function(){this.scroller_height=this.$scroll_container.height(),this.scroller_width=this.$scroll_container.width()},_.drag_handler=function(t){if(!this.disabled&&(1===t.which||o)&&!this.ignore_drag(t)){var s=this,e=!0;return this.$player=i(t.currentTarget),this.el_init_pos=this.get_actual_pos(this.$player),this.mouse_init_pos=this.get_mouse_pos(t),this.offsetY=this.mouse_init_pos.top-this.el_init_pos.top,this.$document.on(this.pointer_events.move,function(i){var t=s.get_mouse_pos(i),o=Math.abs(t.left-s.mouse_init_pos.left),r=Math.abs(t.top-s.mouse_init_pos.top);return(o>s.options.distance||r>s.options.distance)&&(e?(e=!1,s.on_dragstart.call(s,i),!1):(!0===s.is_dragging&&s.on_dragmove.call(s,i),!1))}),!!o&&void 0}},_.on_dragstart=function(i){if(i.preventDefault(),this.is_dragging)return this;this.drag_start=this.is_dragging=!0;var t=this.$container.offset();return this.baseX=Math.round(t.left),this.baseY=Math.round(t.top),"clone"===this.options.helper?(this.$helper=this.$player.clone().appendTo(this.$container).addClass("helper"),this.helper=!0):this.helper=!1,this.scroll_container_offset_y=this.$scroll_container.scrollTop(),this.scroll_container_offset_x=this.$scroll_container.scrollLeft(),this.el_init_offset=this.$player.offset(),this.player_width=this.$player.width(),this.player_height=this.$player.height(),this.set_limits(this.options.container_width),this.options.start&&this.options.start.call(this.$player,i,this.get_drag_data(i)),!1},_.on_dragmove=function(i){var t=this.get_drag_data(i);this.options.autoscroll&&this.manage_scroll(t),this.options.move_element&&(this.helper?this.$helper:this.$player).css({position:"absolute",left:t.position.left,top:t.position.top});var s=this.last_position||t.position;return t.prev_position=s,this.options.drag&&this.options.drag.call(this.$player,i,t),this.last_position=t.position,!1},_.on_dragstop=function(i){var t=this.get_drag_data(i);return this.drag_start=!1,this.options.stop&&this.options.stop.call(this.$player,i,t),this.helper&&this.options.remove_helper&&this.$helper.remove(),!1},_.on_select_start=function(i){if(!this.disabled&&!this.ignore_drag(i))return!1},_.enable=function(){this.disabled=!1},_.disable=function(){this.disabled=!0},_.destroy=function(){this.disable(),this.$container.off(this.ns),this.$document.off(this.ns),s.off(this.ns),i.removeData(this.$container,"drag")},_.ignore_drag=function(t){return this.options.handle?!i(t.target).is(this.options.handle):i.isFunction(this.options.ignore_dragging)?this.options.ignore_dragging(t):this.options.resize?!i(t.target).is(this.options.items):i(t.target).is(this.options.ignore_dragging.join(", "))},i.fn.gridDraggable=function(i){return new n(this,i)},i.fn.dragg=function(t){return this.each(function(){i.data(this,"drag")||i.data(this,"drag",new n(this,t))})},n}),function(i,t){"use strict";"object"==typeof exports?module.exports=t(require("jquery"),require("./jquery.draggable.js"),require("./jquery.collision.js"),require("./jquery.coords.js"),require("./utils.js")):"function"==typeof define&&define.amd?define(["jquery","gridster-draggable","gridster-collision"],t):i.Gridster=t(i.$||i.jQuery,i.GridsterDraggable,i.GridsterCollision)}(this,function(i,t,s){"use strict";var e=i(window),o={namespace:"",widget_selector:"li",static_class:"static",widget_margins:[10,10],widget_base_dimensions:[400,225],extra_rows:0,extra_cols:0,min_cols:1,max_cols:1/0,limit:{width:!0,height:!1},min_rows:1,max_rows:15,autogenerate_stylesheet:!0,avoid_overlapped_widgets:!0,auto_init:!0,center_widgets:!1,responsive_breakpoint:!1,scroll_container:window,shift_larger_widgets_down:!0,move_widgets_down_only:!1,shift_widgets_up:!0,show_element:function(i,t){t?i.fadeIn(t):i.fadeIn()},hide_element:function(i,t){t?i.fadeOut(t):i.fadeOut()},serialize_params:function(i,t){return{col:t.col,row:t.row,size_x:t.size_x,size_y:t.size_y}},collision:{wait_for_mouseup:!1},draggable:{items:".gs-w:not(.static)",distance:4,ignore_dragging:t.defaults.ignore_dragging.slice(0)},resize:{enabled:!1,axes:["both"],handle_append_to:"",handle_class:"gs-resize-handle",max_size:[1/0,1/0],min_size:[1,1]},ignore_self_occupied:!1};function r(t,s){this.options=i.extend(!0,{},o,s),this.options.draggable=this.options.draggable||{},this.options.draggable=i.extend(!0,{},this.options.draggable,{scroll_container:this.options.scroll_container}),this.$el=i(t),this.$scroll_container=this.options.scroll_container===window?i(window):this.$el.closest(this.options.scroll_container),this.$wrapper=this.$el.parent(),this.$widgets=this.$el.children(this.options.widget_selector).addClass("gs-w"),this.$changed=i([]),this.w_queue={},this.is_responsive()?this.min_widget_width=this.get_responsive_col_width():this.min_widget_width=this.options.widget_base_dimensions[0],this.min_widget_height=this.options.widget_base_dimensions[1],this.is_resizing=!1,this.min_col_count=this.options.min_cols,this.prev_col_count=this.min_col_count,this.generated_stylesheets=[],this.$style_tags=i([]),typeof this.options.limit==typeof!0&&(console.log("limit: bool is deprecated, consider using limit: { width: boolean, height: boolean} instead"),this.options.limit={width:this.options.limit,height:this.options.limit}),this.options.auto_init&&this.init()}function a(i){for(var t=["col","row","size_x","size_y"],s={},e=0,o=t.length;e<o;e++){var r=t[e];if(!(r in i))throw new Error("Not exists property `"+r+"`");var a=i[r];if(!a||isNaN(a))throw new Error("Invalid value of `"+r+"` property");s[r]=+a}return s}r.defaults=o,r.generated_stylesheets=[],r.sort_by_row_asc=function(t){return t=t.sort(function(t,s){return t.row||(t=i(t).coords().grid,s=i(s).coords().grid),t=a(t),s=a(s),t.row>s.row?1:-1})},r.sort_by_row_and_col_asc=function(i){return i=i.sort(function(i,t){return i=a(i),t=a(t),i.row>t.row||i.row===t.row&&i.col>t.col?1:-1})},r.sort_by_col_asc=function(i){return i=i.sort(function(i,t){return i=a(i),t=a(t),i.col>t.col?1:-1})},r.sort_by_row_desc=function(i){return i=i.sort(function(i,t){return i=a(i),t=a(t),i.row+i.size_y<t.row+t.size_y?1:-1})};var n=r.prototype;return n.init=function(){this.options.resize.enabled&&this.setup_resize(),this.generate_grid_and_stylesheet(),this.get_widgets_from_DOM(),this.set_dom_grid_height(),this.set_dom_grid_width(),this.$wrapper.addClass("ready"),this.draggable(),this.options.resize.enabled&&this.resizable(),this.options.center_widgets&&setTimeout(i.proxy(function(){this.center_widgets()},this),0),e.bind("resize.gridster",throttle(i.proxy(this.recalculate_faux_grid,this),200))},n.disable=function(){return this.$wrapper.find(".player-revert").removeClass("player-revert"),this.drag_api.disable(),this},n.enable=function(){return this.drag_api.enable(),this},n.disable_resize=function(){return this.$el.addClass("gs-resize-disabled"),this.resize_api.disable(),this},n.enable_resize=function(){return this.$el.removeClass("gs-resize-disabled"),this.resize_api.enable(),this},n.add_widget=function(t,s,e,o,r,a,n,_){var h;if(s||(s=1),e||(e=1),o||r)h={col:o,row:r,size_x:s,size_y:e},this.options.avoid_overlapped_widgets&&this.empty_cells(o,r,s,e);else if(!1===(h=this.next_position(s,e)))return!1;var d=i(t).attr({"data-col":h.col,"data-row":h.row,"data-sizex":s,"data-sizey":e}).addClass("gs-w").appendTo(this.$el).hide();this.$widgets=this.$widgets.add(d),this.$changed=this.$changed.add(d),this.register_widget(d);var l=parseInt(h.row)+(parseInt(h.size_y)-1);return this.rows<l&&this.add_faux_rows(l-this.rows),a&&this.set_widget_max_size(d,a),n&&this.set_widget_min_size(d,n),this.set_dom_grid_width(),this.set_dom_grid_height(),this.drag_api.set_limits(this.cols*this.min_widget_width+(this.cols+1)*this.options.widget_margins[0]),this.options.center_widgets&&setTimeout(i.proxy(function(){this.center_widgets()},this),0),this.options.show_element.call(this,d,_),d},n.set_widget_min_size=function(i,t){if(!(i="number"==typeof i?this.$widgets.eq(i):i).length)return this;var s=i.data("coords").grid;return s.min_size_x=t[0],s.min_size_y=t[1],this},n.set_widget_max_size=function(i,t){if(!(i="number"==typeof i?this.$widgets.eq(i):i).length)return this;var s=i.data("coords").grid;return s.max_size_x=t[0],s.max_size_y=t[1],this},n.add_resize_handle=function(t){var s=this.options.resize.handle_append_to?i(this.options.resize.handle_append_to,t):t;return 0===s.children("span[class~='"+this.resize_handle_class+"']").length&&i(this.resize_handle_tpl).appendTo(s),this},n.resize_widget=function(i,t,s,e){var o=i.coords().grid;this.is_resizing=!0,t||(t=o.size_x),s||(s=o.size_y),this.is_valid_row(o.row,s)||this.add_faux_rows(Math.max(this.calculate_highest_row(o.row,s)-this.rows,0)),this.is_valid_col(o.col,s)||this.add_faux_cols(Math.max(this.calculate_highest_row(o.col,t)-this.cols,0));var r={col:o.col,row:o.row,size_x:t,size_y:s};return this.mutate_widget_in_gridmap(i,o,r),this.set_dom_grid_height(),this.set_dom_grid_width(),e&&e.call(this,r.size_x,r.size_y),this.is_resizing=!1,i},n.expand_widget=function(t,s,e,o,r){var a=t.coords().grid,n=Math.floor((i(window).width()-2*this.options.widget_margins[0])/this.min_widget_width);s=s||Math.min(n,this.cols),e||(e=a.size_y);var _=a.size_y;t.attr("pre_expand_col",a.col),t.attr("pre_expand_sizex",a.size_x),t.attr("pre_expand_sizey",a.size_y);var h=o||1;e>_&&this.add_faux_rows(Math.max(e-_,0));var d={col:h,row:a.row,size_x:s,size_y:e};return this.mutate_widget_in_gridmap(t,a,d),this.set_dom_grid_height(),this.set_dom_grid_width(),r&&r.call(this,d.size_x,d.size_y),t},n.collapse_widget=function(i,t){var s=i.coords().grid,e=parseInt(i.attr("pre_expand_sizex")),o=parseInt(i.attr("pre_expand_sizey")),r={col:parseInt(i.attr("pre_expand_col")),row:s.row,size_x:e,size_y:o};return this.mutate_widget_in_gridmap(i,s,r),this.set_dom_grid_height(),this.set_dom_grid_width(),t&&t.call(this,r.size_x,r.size_y),i},n.fit_to_content=function(i,t,s,e){var o=i.coords().grid,r=this.$wrapper.width(),a=this.$wrapper.height(),n=this.options.widget_base_dimensions[0]+2*this.options.widget_margins[0],_=this.options.widget_base_dimensions[1]+2*this.options.widget_margins[1],h=Math.ceil((r+2*this.options.widget_margins[0])/n),d=Math.ceil((a+2*this.options.widget_margins[1])/_),l={col:o.col,row:o.row,size_x:Math.min(t,h),size_y:Math.min(s,d)};return this.mutate_widget_in_gridmap(i,o,l),this.set_dom_grid_height(),this.set_dom_grid_width(),e&&e.call(this,l.size_x,l.size_y),i},n.center_widgets=debounce(function(){var t,s=this.$wrapper.width();t=this.is_responsive()?this.get_responsive_col_width():this.options.widget_base_dimensions[0]+2*this.options.widget_margins[0];var e=2*Math.floor(Math.max(Math.floor(s/t),this.min_col_count)/2);this.options.min_cols=e,this.options.max_cols=e,this.options.extra_cols=0,this.set_dom_grid_width(e),this.cols=e;var o=(e-this.prev_col_count)/2;return o<0?(this.get_min_col()>-1*o?this.shift_cols(o):this.resize_widget_dimensions(this.options),setTimeout(i.proxy(function(){this.resize_widget_dimensions(this.options)},this),0)):o>0?(this.resize_widget_dimensions(this.options),setTimeout(i.proxy(function(){this.shift_cols(o)},this),0)):(this.resize_widget_dimensions(this.options),setTimeout(i.proxy(function(){this.resize_widget_dimensions(this.options)},this),0)),this.prev_col_count=e,this},200),n.get_min_col=function(){return Math.min.apply(Math,this.$widgets.map(i.proxy(function(t,s){return this.get_cells_occupied(i(s).coords().grid).cols},this)).get())},n.shift_cols=function(t){var s=this.$widgets.map(i.proxy(function(t,s){var e=i(s);return this.dom_to_coords(e)},this));(s=r.sort_by_row_and_col_asc(s)).each(i.proxy(function(s,e){var o=i(e.el),r=o.coords().grid,a=parseInt(o.attr("data-col")),n={col:Math.max(Math.round(a+t),1),row:r.row,size_x:r.size_x,size_y:r.size_y};setTimeout(i.proxy(function(){this.mutate_widget_in_gridmap(o,r,n)},this),0)},this))},n.mutate_widget_in_gridmap=function(t,s,e){var o=s.size_y,r=this.get_cells_occupied(s),a=this.get_cells_occupied(e),n=[];i.each(r.cols,function(t,s){-1===i.inArray(s,a.cols)&&n.push(s)});var _=[];i.each(a.cols,function(t,s){-1===i.inArray(s,r.cols)&&_.push(s)});var h=[];i.each(r.rows,function(t,s){-1===i.inArray(s,a.rows)&&h.push(s)});var d=[];if(i.each(a.rows,function(t,s){-1===i.inArray(s,r.rows)&&d.push(s)}),this.remove_from_gridmap(s),_.length){var l=[e.col,e.row,e.size_x,Math.min(o,e.size_y),t];this.empty_cells.apply(this,l)}if(d.length){var c=[e.col,e.row,e.size_x,e.size_y,t];this.empty_cells.apply(this,c)}if(s.col=e.col,s.row=e.row,s.size_x=e.size_x,s.size_y=e.size_y,this.add_to_gridmap(e,t),t.removeClass("player-revert"),this.update_widget_dimensions(t,e),this.options.shift_widgets_up){if(n.length){var p=[n[0],e.row,n[n.length-1]-n[0]+1,Math.min(o,e.size_y),t];this.remove_empty_cells.apply(this,p)}if(h.length){var g=[e.col,e.row,e.size_x,e.size_y,t];this.remove_empty_cells.apply(this,g)}}return this.move_widget_up(t),this},n.empty_cells=function(t,s,e,o,r){return this.widgets_below({col:t,row:s-o,size_x:e,size_y:o}).not(r).each(i.proxy(function(t,e){var r=i(e),a=r.coords().grid;if(a.row<=s+o-1){var n=s+o-a.row;this.move_widget_down(r,n)}},this)),this.is_resizing||this.set_dom_grid_height(),this},n.remove_empty_cells=function(t,s,e,o,r){return this.widgets_below({col:t,row:s,size_x:e,size_y:o}).not(r).each(i.proxy(function(t,s){this.move_widget_up(i(s),o)},this)),this.set_dom_grid_height(),this},n.next_position=function(i,t){i||(i=1),t||(t=1);for(var s,e=this.gridmap,o=e.length,a=[],n=1;n<o;n++){s=e[n].length;for(var _=1;_<=s;_++){this.can_move_to({size_x:i,size_y:t},n,_)&&a.push({col:n,row:_,size_y:t,size_x:i})}}return!!a.length&&r.sort_by_row_and_col_asc(a)[0]},n.remove_by_grid=function(i,t){var s=this.is_widget(i,t);s&&this.remove_widget(s)},n.remove_widget=function(t,s,e){var o=t instanceof i?t:i(t);if(0===o.length)return this;var r=o.coords().grid;if(void 0===r)return this;i.isFunction(s)&&(e=s,s=!1),this.cells_occupied_by_placeholder={},this.$widgets=this.$widgets.not(o);var a=this.widgets_below(o);return this.remove_from_gridmap(r),this.options.hide_element.call(this,o,i.proxy(function(){o.remove(),s||a.each(i.proxy(function(t,s){this.move_widget_up(i(s),r.size_y)},this)),this.set_dom_grid_height(),e&&e.call(this,t)},this)),this},n.remove_all_widgets=function(t){return this.$widgets.each(i.proxy(function(i,s){this.remove_widget(s,!0,t)},this)),this},n.serialize=function(t){t||(t=this.$widgets);var s=[];return t.each(i.proxy(function(t,e){var o=i(e);void 0!==o.coords().grid&&s.push(this.options.serialize_params(o,o.coords().grid))},this)),s},n.serialize_changed=function(){return this.serialize(this.$changed)},n.dom_to_coords=function(i){return{col:parseInt(i.attr("data-col"),10),row:parseInt(i.attr("data-row"),10),size_x:parseInt(i.attr("data-sizex"),10)||1,size_y:parseInt(i.attr("data-sizey"),10)||1,max_size_x:parseInt(i.attr("data-max-sizex"),10)||!1,max_size_y:parseInt(i.attr("data-max-sizey"),10)||!1,min_size_x:parseInt(i.attr("data-min-sizex"),10)||!1,min_size_y:parseInt(i.attr("data-min-sizey"),10)||!1,el:i}},n.register_widget=function(t){var s=t instanceof i,e=s?this.dom_to_coords(t):t,o=!1;s||(t=e.el);var r=this.can_go_widget_up(e);return this.options.shift_widgets_up&&r&&(e.row=r,t.attr("data-row",r),this.$el.trigger("gridster:positionchanged",[e]),o=!0),this.options.avoid_overlapped_widgets&&!this.can_move_to({size_x:e.size_x,size_y:e.size_y},e.col,e.row)&&(i.extend(e,this.next_position(e.size_x,e.size_y)),t.attr({"data-col":e.col,"data-row":e.row,"data-sizex":e.size_x,"data-sizey":e.size_y}),o=!0),t.data("coords",t.coords()),t.data("coords").grid=e,this.add_to_gridmap(e,t),this.update_widget_dimensions(t,e),this.options.resize.enabled&&this.add_resize_handle(t),o},n.update_widget_position=function(i,t){return this.for_each_cell_occupied(i,function(i,s){if(!this.gridmap[i])return this;this.gridmap[i][s]=t}),this},n.update_widget_dimensions=function(i,t){var s=t.size_x*(this.is_responsive()?this.get_responsive_col_width():this.options.widget_base_dimensions[0])+(t.size_x-1)*this.options.widget_margins[0],e=t.size_y*this.options.widget_base_dimensions[1]+(t.size_y-1)*this.options.widget_margins[1];return i.data("coords").update({width:s,height:e}),i.attr({"data-col":t.col,"data-row":t.row,"data-sizex":t.size_x,"data-sizey":t.size_y}),this},n.update_widgets_dimensions=function(){return i.each(this.$widgets,i.proxy(function(t,s){var e=i(s).coords().grid;"object"==typeof e&&this.update_widget_dimensions(i(s),e)},this)),this},n.remove_from_gridmap=function(i){return this.update_widget_position(i,!1)},n.add_to_gridmap=function(i,t){this.update_widget_position(i,t||i.el)},n.draggable=function(){var t=this,s=i.extend(!0,{},this.options.draggable,{offset_left:this.options.widget_margins[0],offset_top:this.options.widget_margins[1],container_width:this.cols*this.min_widget_width+(this.cols+1)*this.options.widget_margins[0],container_height:this.rows*this.min_widget_height+(this.rows+1)*this.options.widget_margins[0],limit:{width:this.options.limit.width,height:this.options.limit.height},start:function(s,e){t.$widgets.filter(".player-revert").removeClass("player-revert"),t.$player=i(this),t.$helper=i(e.$helper),t.helper=!t.$helper.is(t.$player),t.on_start_drag.call(t,s,e),t.$el.trigger("gridster:dragstart")},stop:function(i,s){t.on_stop_drag.call(t,i,s),t.$el.trigger("gridster:dragstop")},drag:throttle(function(i,s){t.on_drag.call(t,i,s),t.$el.trigger("gridster:drag")},60)});this.drag_api=this.$el.dragg(s).data("drag")},n.resizable=function(){return this.resize_api=this.$el.gridDraggable({items:"."+this.options.resize.handle_class,offset_left:this.options.widget_margins[0],container_width:this.container_width,move_element:!1,resize:!0,limit:{width:this.options.max_cols!==1/0||this.options.limit.width,height:this.options.max_rows!==1/0||this.options.limit.height},scroll_container:this.options.scroll_container,start:i.proxy(this.on_start_resize,this),stop:i.proxy(function(t,s){delay(i.proxy(function(){this.on_stop_resize(t,s)},this),120)},this),drag:throttle(i.proxy(this.on_resize,this),60)}),this},n.setup_resize=function(){this.resize_handle_class=this.options.resize.handle_class;var t=this.options.resize.axes,s='<span class="'+this.resize_handle_class+" "+this.resize_handle_class+'-{type}" />';return this.resize_handle_tpl=i.map(t,function(i){return s.replace("{type}",i)}).join(""),i.isArray(this.options.draggable.ignore_dragging)&&this.options.draggable.ignore_dragging.push("."+this.resize_handle_class),this},n.on_start_drag=function(t,s){this.$helper.add(this.$player).add(this.$wrapper).addClass("dragging"),this.highest_col=this.get_highest_occupied_cell().col,this.$player.addClass("player"),this.player_grid_data=this.$player.coords().grid,this.placeholder_grid_data=i.extend({},this.player_grid_data),this.get_highest_occupied_cell().row+this.player_grid_data.size_y<=this.options.max_rows&&this.set_dom_grid_height(this.$el.height()+this.player_grid_data.size_y*this.min_widget_height),this.set_dom_grid_width(this.cols);var e=this.player_grid_data.size_x,o=this.cols-this.highest_col;this.options.max_cols===1/0&&o<=e&&this.add_faux_cols(Math.min(e-o,1));var r=this.faux_grid,a=this.$player.data("coords").coords;this.cells_occupied_by_player=this.get_cells_occupied(this.player_grid_data),this.cells_occupied_by_placeholder=this.get_cells_occupied(this.placeholder_grid_data),this.last_cols=[],this.last_rows=[],this.collision_api=this.$helper.collision(r,this.options.collision),this.$preview_holder=i("<"+this.$player.get(0).tagName+" />",{class:"preview-holder","data-row":this.$player.attr("data-row"),"data-col":this.$player.attr("data-col"),css:{width:a.width,height:a.height}}).appendTo(this.$el),this.options.draggable.start&&this.options.draggable.start.call(this,t,s)},n.on_drag=function(i,t){if(null===this.$player)return!1;var s=this.options.widget_margins,e=this.$preview_holder.attr("data-col"),o=this.$preview_holder.attr("data-row"),r={left:t.position.left+this.baseX-s[0]*e,top:t.position.top+this.baseY-s[1]*o};this.options.max_cols===1/0&&(this.placeholder_grid_data.col+this.placeholder_grid_data.size_x-1>=this.cols-1&&this.options.max_cols>=this.cols+1&&(this.add_faux_cols(1),this.set_dom_grid_width(this.cols+1),this.drag_api.set_limits(this.cols*this.min_widget_width+(this.cols+1)*this.options.widget_margins[0])),this.collision_api.set_colliders(this.faux_grid));this.colliders_data=this.collision_api.get_closest_colliders(r),this.on_overlapped_column_change(this.on_start_overlapping_column,this.on_stop_overlapping_column),this.on_overlapped_row_change(this.on_start_overlapping_row,this.on_stop_overlapping_row),this.helper&&this.$player&&this.$player.css({left:t.position.left,top:t.position.top}),this.options.draggable.drag&&this.options.draggable.drag.call(this,i,t)},n.on_stop_drag=function(i,t){this.$helper.add(this.$player).add(this.$wrapper).removeClass("dragging");var s=this.options.widget_margins,e=this.$preview_holder.attr("data-col"),o=this.$preview_holder.attr("data-row");t.position.left=t.position.left+this.baseX-s[0]*e,t.position.top=t.position.top+this.baseY-s[1]*o,this.colliders_data=this.collision_api.get_closest_colliders(t.position),this.on_overlapped_column_change(this.on_start_overlapping_column,this.on_stop_overlapping_column),this.on_overlapped_row_change(this.on_start_overlapping_row,this.on_stop_overlapping_row),this.$changed=this.$changed.add(this.$player);var r=this.placeholder_grid_data.el.coords().grid;r.col===this.placeholder_grid_data.col&&r.row===this.placeholder_grid_data.row||(this.update_widget_position(r,!1),this.options.collision.wait_for_mouseup&&this.for_each_cell_occupied(this.placeholder_grid_data,function(i,t){if(this.is_widget(i,t)){var s=this.placeholder_grid_data.row+this.placeholder_grid_data.size_y-parseInt(this.gridmap[i][t][0].getAttribute("data-row"));!this.move_widget_down(this.is_widget(i,t),s)&&this.set_placeholder(this.placeholder_grid_data.el.coords().grid.col,this.placeholder_grid_data.el.coords().grid.row)}})),this.cells_occupied_by_player=this.get_cells_occupied(this.placeholder_grid_data);var a=this.placeholder_grid_data.col,n=this.placeholder_grid_data.row;this.set_cells_player_occupies(a,n),this.$player.coords().grid.row=n,this.$player.coords().grid.col=a,this.$player.addClass("player-revert").removeClass("player").attr({"data-col":a,"data-row":n}).css({left:"",top:""}),this.options.draggable.stop&&this.options.draggable.stop.call(this,i,t),this.$preview_holder.remove(),this.$player=null,this.$helper=null,this.placeholder_grid_data={},this.player_grid_data={},this.cells_occupied_by_placeholder={},this.cells_occupied_by_player={},this.w_queue={},this.set_dom_grid_height(),this.set_dom_grid_width(),this.options.max_cols===1/0&&this.drag_api.set_limits(this.cols*this.min_widget_width+(this.cols+1)*this.options.widget_margins[0])},n.on_start_resize=function(t,s){this.$resized_widget=s.$player.closest(".gs-w"),this.resize_coords=this.$resized_widget.coords(),this.resize_wgd=this.resize_coords.grid,this.resize_initial_width=this.resize_coords.coords.width,this.resize_initial_height=this.resize_coords.coords.height,this.resize_initial_sizex=this.resize_coords.grid.size_x,this.resize_initial_sizey=this.resize_coords.grid.size_y,this.resize_initial_col=this.resize_coords.grid.col,this.resize_last_sizex=this.resize_initial_sizex,this.resize_last_sizey=this.resize_initial_sizey,this.resize_max_size_x=Math.min(this.resize_wgd.max_size_x||this.options.resize.max_size[0],this.options.max_cols-this.resize_initial_col+1),this.resize_max_size_y=this.resize_wgd.max_size_y||this.options.resize.max_size[1],this.resize_min_size_x=this.resize_wgd.min_size_x||this.options.resize.min_size[0]||1,this.resize_min_size_y=this.resize_wgd.min_size_y||this.options.resize.min_size[1]||1,this.resize_initial_last_col=this.get_highest_occupied_cell().col,this.set_dom_grid_width(this.cols),this.resize_dir={right:s.$player.is("."+this.resize_handle_class+"-x"),bottom:s.$player.is("."+this.resize_handle_class+"-y")},this.is_responsive()||this.$resized_widget.css({"min-width":this.options.widget_base_dimensions[0],"min-height":this.options.widget_base_dimensions[1]});var e=this.$resized_widget.get(0).tagName;this.$resize_preview_holder=i("<"+e+" />",{class:"preview-holder resize-preview-holder","data-row":this.$resized_widget.attr("data-row"),"data-col":this.$resized_widget.attr("data-col"),css:{width:this.resize_initial_width,height:this.resize_initial_height}}).appendTo(this.$el),this.$resized_widget.addClass("resizing"),this.options.resize.start&&this.options.resize.start.call(this,t,s,this.$resized_widget),this.$el.trigger("gridster:resizestart")},n.on_stop_resize=function(t,s){this.$resized_widget.removeClass("resizing").css({width:"",height:"","min-width":"","min-height":""}),delay(i.proxy(function(){this.$resize_preview_holder.remove().css({"min-width":"","min-height":""}),this.options.resize.stop&&this.options.resize.stop.call(this,t,s,this.$resized_widget),this.$el.trigger("gridster:resizestop")},this),300),this.set_dom_grid_width(),this.set_dom_grid_height(),this.options.max_cols===1/0&&this.drag_api.set_limits(this.cols*this.min_widget_width)},n.on_resize=function(i,t){var s,e=t.pointer.diff_left,o=t.pointer.diff_top,r=this.is_responsive()?this.get_responsive_col_width():this.options.widget_base_dimensions[0],a=this.options.widget_base_dimensions[1],n=this.options.widget_margins[0],_=this.options.widget_margins[1],h=this.resize_max_size_x,d=this.resize_min_size_x,l=this.resize_max_size_y,c=this.resize_min_size_y,p=this.options.max_cols===1/0,g=Math.ceil(e/(r+2*n)-.2),u=Math.ceil(o/(a+2*_)-.2),w=Math.max(1,this.resize_initial_sizex+g),f=Math.max(1,this.resize_initial_sizey+u),m=Math.floor(this.container_width/this.min_widget_width-this.resize_initial_col+1),y=m*this.min_widget_width+(m-1)*n;w=Math.max(Math.min(w,h),d),s=h*r+((w=Math.min(m,w))-1)*n;var v=Math.min(s,y),z=d*r+(w-1)*n,x=l*a+((f=Math.max(Math.min(f,l),c))-1)*_,$=c*a+(f-1)*_;if(this.resize_dir.right?f=this.resize_initial_sizey:this.resize_dir.bottom&&(w=this.resize_initial_sizex),p){var b=this.resize_initial_col+w-1;p&&this.resize_initial_last_col<=b&&(this.set_dom_grid_width(Math.max(b+1,this.cols)),this.cols<b&&this.add_faux_cols(b-this.cols))}var M={};!this.resize_dir.bottom&&(M.width=Math.max(Math.min(this.resize_initial_width+e,v),z)),!this.resize_dir.right&&(M.height=Math.max(Math.min(this.resize_initial_height+o,x),$)),this.$resized_widget.css(M),w===this.resize_last_sizex&&f===this.resize_last_sizey||(this.resize_widget(this.$resized_widget,w,f,!1),this.set_dom_grid_width(this.cols),this.$resize_preview_holder.css({width:"",height:""}).attr({"data-row":this.$resized_widget.attr("data-row"),"data-sizex":w,"data-sizey":f})),this.options.resize.resize&&this.options.resize.resize.call(this,i,t,this.$resized_widget),this.$el.trigger("gridster:resize"),this.resize_last_sizex=w,this.resize_last_sizey=f},n.on_overlapped_column_change=function(t,s){if(!this.colliders_data.length)return this;var e,o=this.get_targeted_columns(this.colliders_data[0].el.data.col),r=this.last_cols.length,a=o.length;for(e=0;e<a;e++)-1===i.inArray(o[e],this.last_cols)&&(t||i.noop).call(this,o[e]);for(e=0;e<r;e++)-1===i.inArray(this.last_cols[e],o)&&(s||i.noop).call(this,this.last_cols[e]);return this.last_cols=o,this},n.on_overlapped_row_change=function(t,s){if(!this.colliders_data.length)return this;var e,o=this.get_targeted_rows(this.colliders_data[0].el.data.row),r=this.last_rows.length,a=o.length;for(e=0;e<a;e++)-1===i.inArray(o[e],this.last_rows)&&(t||i.noop).call(this,o[e]);for(e=0;e<r;e++)-1===i.inArray(this.last_rows[e],o)&&(s||i.noop).call(this,this.last_rows[e]);this.last_rows=o},n.set_player=function(t,s,e){var o=!1,r=e?{col:t}:this.colliders_data[0].el.data,a=r.col,n=r.row||s;this.player_grid_data={col:a,row:n,size_y:this.player_grid_data.size_y,size_x:this.player_grid_data.size_x},this.cells_occupied_by_player=this.get_cells_occupied(this.player_grid_data),this.cells_occupied_by_placeholder=this.get_cells_occupied(this.placeholder_grid_data);var _=this.get_widgets_overlapped(this.player_grid_data),h=this.player_grid_data.size_y,d=this.player_grid_data.size_x,l=this.cells_occupied_by_placeholder,c=this;if(_.each(i.proxy(function(t,s){var e=i(s),r=e.coords().grid,p=l.cols[0]+d-1,g=l.rows[0]+h-1;if(e.hasClass(c.options.static_class))return!0;if(c.options.collision.wait_for_mouseup&&c.drag_api.is_dragging)c.placeholder_grid_data.col=a,c.placeholder_grid_data.row=n,c.cells_occupied_by_placeholder=c.get_cells_occupied(c.placeholder_grid_data),c.$preview_holder.attr({"data-row":n,"data-col":a});else if(r.size_x<=d&&r.size_y<=h)if(c.is_swap_occupied(l.cols[0],r.row,r.size_x,r.size_y)||c.is_player_in(l.cols[0],r.row)||c.is_in_queue(l.cols[0],r.row,e))if(c.is_swap_occupied(p,r.row,r.size_x,r.size_y)||c.is_player_in(p,r.row)||c.is_in_queue(p,r.row,e))if(c.is_swap_occupied(r.col,l.rows[0],r.size_x,r.size_y)||c.is_player_in(r.col,l.rows[0])||c.is_in_queue(r.col,l.rows[0],e))if(c.is_swap_occupied(r.col,g,r.size_x,r.size_y)||c.is_player_in(r.col,g)||c.is_in_queue(r.col,g,e))if(c.is_swap_occupied(l.cols[0],l.rows[0],r.size_x,r.size_y)||c.is_player_in(l.cols[0],l.rows[0])||c.is_in_queue(l.cols[0],l.rows[0],e))for(var u=0;u<d;u++)for(var w=0;w<h;w++){var f=l.cols[0]+u,m=l.rows[0]+w;if(!c.is_swap_occupied(f,m,r.size_x,r.size_y)&&!c.is_player_in(f,m)&&!c.is_in_queue(f,m,e)){o=c.queue_widget(f,m,e),u=d;break}}else c.options.move_widgets_down_only?_.each(i.proxy(function(t,s){var e=i(s);c.can_go_down(e)&&e.coords().grid.row===c.player_grid_data.row&&!c.is_in_queue(p,r.row,e)&&(c.move_widget_down(e,c.player_grid_data.size_y),c.set_placeholder(a,n))})):o=c.queue_widget(l.cols[0],l.rows[0],e);else o=c.queue_widget(r.col,g,e);else o=c.queue_widget(r.col,l.rows[0],e);else o=c.queue_widget(p,r.row,e);else c.options.move_widgets_down_only?_.each(i.proxy(function(t,s){var e=i(s);c.can_go_down(e)&&e.coords().grid.row===c.player_grid_data.row&&!c.is_in_queue(e.coords().grid.col,r.row,e)&&(c.move_widget_down(e,c.player_grid_data.size_y),c.set_placeholder(a,n))})):o=c.queue_widget(l.cols[0],r.row,e);else c.options.shift_larger_widgets_down&&!o&&_.each(i.proxy(function(t,s){var e=i(s);c.can_go_down(e)&&e.coords().grid.row===c.player_grid_data.row&&(c.move_widget_down(e,c.player_grid_data.size_y),c.set_placeholder(a,n))}));c.clean_up_changed()})),o&&this.can_placeholder_be_set(a,n,d,h)){for(var p in this.w_queue){var g=parseInt(p.split("_")[0]),u=parseInt(p.split("_")[1]);"full"!==this.w_queue[p]&&this.new_move_widget_to(this.w_queue[p],g,u)}this.set_placeholder(a,n)}if(!_.length){if(this.options.shift_widgets_up){var w=this.can_go_player_up(this.player_grid_data);!1!==w&&(n=w)}this.can_placeholder_be_set(a,n,d,h)&&this.set_placeholder(a,n)}return this.w_queue={},{col:a,row:n}},n.is_swap_occupied=function(i,t,s,e){for(var o=!1,r=0;r<s;r++)for(var a=0;a<e;a++){var n=i+r,_=t+a,h=n+"_"+_;if(this.is_occupied(n,_))o=!0;else if(h in this.w_queue){if("full"===this.w_queue[h]){o=!0;continue}var d=this.w_queue[h].coords().grid;this.is_widget_under_player(d.col,d.row)||delete this.w_queue[h]}_>parseInt(this.options.max_rows)&&(o=!0),n>parseInt(this.options.max_cols)&&(o=!0),this.is_player_in(n,_)&&(o=!0)}return o},n.can_placeholder_be_set=function(i,t,s,e){for(var o=!0,r=0;r<s;r++)for(var a=0;a<e;a++){var n=i+r,_=t+a,h=this.is_widget(n,_);_>parseInt(this.options.max_rows)&&(o=!1),n>parseInt(this.options.max_cols)&&(o=!1),this.is_occupied(n,_)&&!this.is_widget_queued_and_can_move(h)&&(o=!1)}return o},n.queue_widget=function(i,t,s){var e=s,o=e.coords().grid,r=i+"_"+t;if(r in this.w_queue)return!1;this.w_queue[r]=e;for(var a=0;a<o.size_x;a++)for(var n=0;n<o.size_y;n++){var _=i+a+"_"+(t+n);_!==r&&(this.w_queue[_]="full")}return!0},n.is_widget_queued_and_can_move=function(i){var t=!1;if(!1===i)return!1;for(var s in this.w_queue)if("full"!==this.w_queue[s]&&this.w_queue[s].attr("data-col")===i.attr("data-col")&&this.w_queue[s].attr("data-row")===i.attr("data-row")){t=!0;for(var e=this.w_queue[s],o=parseInt(s.split("_")[0]),r=parseInt(s.split("_")[1]),a=e.coords().grid,n=0;n<a.size_x;n++)for(var _=0;_<a.size_y;_++){var h=o+n,d=r+_;this.is_player_in(h,d)&&(t=!1)}}return t},n.is_in_queue=function(i,t,s){var e=!1,o=i+"_"+t;if(o in this.w_queue)if("full"===this.w_queue[o])e=!0;else{var r=this.w_queue[o].coords().grid;this.is_widget_under_player(r.col,r.row)?this.w_queue[o].attr("data-col")===s.attr("data-col")&&this.w_queue[o].attr("data-row")===s.attr("data-row")?(delete this.w_queue[o],e=!1):e=!0:(delete this.w_queue[o],e=!1)}return e},n.widgets_constraints=function(t){var s=i([]),e=[],o=[];return t.each(i.proxy(function(t,r){var a=i(r),n=a.coords().grid;this.can_go_widget_up(n)?(s=s.add(a),e.push(n)):o.push(n)},this)),t.not(s),{can_go_up:r.sort_by_row_asc(e),can_not_go_up:r.sort_by_row_desc(o)}},n.manage_movements=function(t,s,e){return i.each(t,i.proxy(function(i,t){var o=t,r=o.el,a=this.can_go_widget_up(o);if(a)this.move_widget_to(r,a),this.set_placeholder(s,a+o.size_y);else if(!this.can_go_player_up(this.player_grid_data)){var n=e+this.player_grid_data.size_y-o.row;this.can_go_down(r)&&(console.log("In Move Down!"),this.move_widget_down(r,n),this.set_placeholder(s,e))}},this)),this},n.is_player=function(i,t){if(t&&!this.gridmap[i])return!1;var s=t?this.gridmap[i][t]:i;return s&&(s.is(this.$player)||s.is(this.$helper))},n.is_player_in=function(t,s){var e=this.cells_occupied_by_player||{};return i.inArray(t,e.cols)>=0&&i.inArray(s,e.rows)>=0},n.is_placeholder_in=function(t,s){var e=this.cells_occupied_by_placeholder||{};return this.is_placeholder_in_col(t)&&i.inArray(s,e.rows)>=0},n.is_placeholder_in_col=function(t){var s=this.cells_occupied_by_placeholder||[];return i.inArray(t,s.cols)>=0},n.is_empty=function(i,t){return void 0===this.gridmap[i]||void 0!==this.gridmap[i][t]&&!1===this.gridmap[i][t]},n.is_valid_col=function(i,t){return this.options.max_cols===1/0||this.cols>=this.calculate_highest_col(i,t)},n.is_valid_row=function(i,t){return this.rows>=this.calculate_highest_row(i,t)},n.calculate_highest_col=function(i,t){return i+(t||1)-1},n.calculate_highest_row=function(i,t){return i+(t||1)-1},n.is_occupied=function(t,s){return!!this.gridmap[t]&&(!this.is_player(t,s)&&(!!this.gridmap[t][s]&&(!this.options.ignore_self_occupied||this.$player.data()!==i(this.gridmap[t][s]).data())))},n.is_widget=function(i,t){var s=this.gridmap[i];return s&&(s=s[t])||!1},n.is_static=function(i,t){var s=this.gridmap[i];return!!s&&!(!(s=s[t])||!s.hasClass(this.options.static_class))},n.is_widget_under_player=function(i,t){return!!this.is_widget(i,t)&&this.is_player_in(i,t)},n.get_widgets_under_player=function(t){t||(t=this.cells_occupied_by_player||{cols:[],rows:[]});var s=i([]);return i.each(t.cols,i.proxy(function(e,o){i.each(t.rows,i.proxy(function(i,t){this.is_widget(o,t)&&(s=s.add(this.gridmap[o][t]))},this))},this)),s},n.set_placeholder=function(t,s){var e=i.extend({},this.placeholder_grid_data),o=t+e.size_x-1;o>this.cols&&(t-=o-t);var r=this.placeholder_grid_data.row<s,a=this.placeholder_grid_data.col!==t;if(this.placeholder_grid_data.col=t,this.placeholder_grid_data.row=s,this.cells_occupied_by_placeholder=this.get_cells_occupied(this.placeholder_grid_data),this.$preview_holder.attr({"data-row":s,"data-col":t}),this.options.shift_player_up){if(r||a)this.widgets_below({col:e.col,row:e.row,size_y:e.size_y,size_x:e.size_x}).each(i.proxy(function(t,s){var e=i(s),o=e.coords().grid,r=this.can_go_widget_up(o);r&&this.move_widget_to(e,r)},this));var n=this.get_widgets_under_player(this.cells_occupied_by_placeholder);n.length&&n.each(i.proxy(function(t,o){var r=i(o);this.move_widget_down(r,s+e.size_y-r.data("coords").grid.row)},this))}},n.can_go_player_up=function(i){var t=i.row+i.size_y-1,s=!0,e=[],o=1e4,r=this.get_widgets_under_player();return this.for_each_column_occupied(i,function(i){var a=this.gridmap[i],n=t+1;for(e[i]=[];--n>0&&(this.is_empty(i,n)||this.is_player(i,n)||this.is_widget(i,n)&&a[n].is(r));)e[i].push(n),o=n<o?n:o;if(0===e[i].length)return s=!1,!0;e[i].sort(function(i,t){return i-t})}),!!s&&this.get_valid_rows(i,e,o)},n.can_go_widget_up=function(i){var t=i.row+i.size_y-1,s=!0,e=[],o=1e4;return this.for_each_column_occupied(i,function(r){var a=this.gridmap[r];e[r]=[];for(var n=t+1;--n>0&&(!this.is_widget(r,n)||this.is_player_in(r,n)||a[n].is(i.el));)this.is_player(r,n)||this.is_placeholder_in(r,n)||this.is_player_in(r,n)||e[r].push(n),n<o&&(o=n);if(0===e[r].length)return s=!1,!0;e[r].sort(function(i,t){return i-t})}),!!s&&this.get_valid_rows(i,e,o)},n.get_valid_rows=function(t,s,e){for(var o=t.row,r=t.row+t.size_y-1,a=t.size_y,n=e-1,_=[];++n<=r;){var h=!0;if(i.each(s,function(t,s){i.isArray(s)&&-1===i.inArray(n,s)&&(h=!1)}),!0===h&&(_.push(n),_.length===a))break}var d=!1;return 1===a?_[0]!==o&&(d=_[0]||!1):_[0]!==o&&(d=this.get_consecutive_numbers_index(_,a)),d},n.get_consecutive_numbers_index=function(i,t){for(var s=i.length,e=[],o=!0,r=-1,a=0;a<s;a++){if(o||i[a]===r+1){if(e.push(a),e.length===t)break;o=!1}else e=[],o=!0;r=i[a]}return e.length>=t&&i[e[0]]},n.get_widgets_overlapped=function(){var t=i([]),s=[],e=this.cells_occupied_by_player.rows.slice(0);return e.reverse(),i.each(this.cells_occupied_by_player.cols,i.proxy(function(o,r){i.each(e,i.proxy(function(e,o){if(!this.gridmap[r])return!0;var a=this.gridmap[r][o];this.is_occupied(r,o)&&!this.is_player(a)&&-1===i.inArray(a,s)&&(t=t.add(a),s.push(a))},this))},this)),t},n.on_start_overlapping_column=function(i){this.set_player(i,void 0,!1)},n.on_start_overlapping_row=function(i){this.set_player(void 0,i,!1)},n.on_stop_overlapping_column=function(i){var t=this;this.options.shift_larger_widgets_down&&this.for_each_widget_below(i,this.cells_occupied_by_player.rows[0],function(i,s){t.move_widget_up(this,t.player_grid_data.size_y)})},n.on_stop_overlapping_row=function(i){var t=this,s=this.cells_occupied_by_player.cols;if(this.options.shift_larger_widgets_down)for(var e=0,o=s.length;e<o;e++)this.for_each_widget_below(s[e],i,function(i,s){t.move_widget_up(this,t.player_grid_data.size_y)})},n.new_move_widget_to=function(i,t,s){var e=i.coords().grid;return this.remove_from_gridmap(e),e.row=s,e.col=t,this.add_to_gridmap(e),i.attr("data-row",s),i.attr("data-col",t),this.update_widget_position(e,i),this.$changed=this.$changed.add(i),this},n.move_widget=function(i,t,s,e){var o=i.coords().grid,r={col:t,row:s,size_x:o.size_x,size_y:o.size_y};return this.mutate_widget_in_gridmap(i,o,r),this.set_dom_grid_height(),this.set_dom_grid_width(),e&&e.call(this,r.col,r.row),i},n.move_widget_to=function(t,s){var e=this,o=t.coords().grid,r=this.widgets_below(t);return!1!==this.can_move_to(o,o.col,s)&&(this.remove_from_gridmap(o),o.row=s,this.add_to_gridmap(o),t.attr("data-row",s),this.$changed=this.$changed.add(t),r.each(function(t,s){var o=i(s),r=o.coords().grid,a=e.can_go_widget_up(r);a&&a!==r.row&&e.move_widget_to(o,a)}),this)},n.move_widget_up=function(t,s){if(void 0===s)return!1;var e=t.coords().grid,o=e.row,r=[];if(s||(s=1),!this.can_go_up(t))return!1;this.for_each_column_occupied(e,function(e){if(-1===i.inArray(t,r)){var a=t.coords().grid,n=o-s;if(!(n=this.can_go_up_to_row(a,e,n)))return!0;this.remove_from_gridmap(a),a.row=n,this.add_to_gridmap(a),t.attr("data-row",a.row),this.$changed=this.$changed.add(t),r.push(t)}})},n.move_widget_down=function(t,s){var e,o,r;if(s<=0)return!1;if((e=t.coords().grid.row)+(t.coords().grid.size_y-1)+s>this.options.max_rows)return!1;if(o=[],r=s,!t)return!1;if(this.failed=!1,-1===i.inArray(t,o)){var a=t.coords().grid,n=e+s;if(this.widgets_below(t).each(i.proxy(function(t,s){if(!0!==this.failed){var e=i(s),o=e.coords().grid,n=this.displacement_diff(o,a,r);n>0&&(this.failed=!1===this.move_widget_down(e,n))}},this)),this.failed)return!1;this.remove_from_gridmap(a),a.row=n,this.update_widget_position(a,t),t.attr("data-row",a.row),this.$changed=this.$changed.add(t),o.push(t)}return!0},n.can_go_up_to_row=function(t,s,e){var o,r=!0,a=[],n=t.row;if(this.for_each_column_occupied(t,function(i){for(a[i]=[],o=n;o--&&this.is_empty(i,o)&&!this.is_placeholder_in(i,o);)a[i].push(o);if(!a[i].length)return r=!1,!0}),!r)return!1;for(o=e,o=1;o<n;o++){for(var _=!0,h=0,d=a.length;h<d;h++)a[h]&&-1===i.inArray(o,a[h])&&(_=!1);if(!0===_){r=o;break}}return r},n.displacement_diff=function(i,t,s){var e=i.row,o=[],r=t.row+t.size_y;return this.for_each_column_occupied(i,function(i){for(var t=0,s=r;s<e;s++)this.is_empty(i,s)&&(t+=1);o.push(t)}),(s-=Math.max.apply(Math,o))>0?s:0},n.widgets_below=function(t){var s=i([]),e=i.isPlainObject(t)?t:t.coords().grid;if(void 0===e)return s;var o=this,a=e.row+e.size_y-1;return this.for_each_column_occupied(e,function(t){o.for_each_widget_below(t,a,function(t,e){if(!o.is_player(this)&&-1===i.inArray(this,s))return s=s.add(this),!0})}),r.sort_by_row_asc(s)},n.set_cells_player_occupies=function(i,t){return this.remove_from_gridmap(this.placeholder_grid_data),this.placeholder_grid_data.col=i,this.placeholder_grid_data.row=t,this.add_to_gridmap(this.placeholder_grid_data,this.$player),this},n.empty_cells_player_occupies=function(){return this.remove_from_gridmap(this.placeholder_grid_data),this},n.can_go_down=function(t){var s=!0,e=this;return t.hasClass(this.options.static_class)&&(s=!1),this.widgets_below(t).each(function(){i(this).hasClass(e.options.static_class)&&(s=!1)}),s},n.can_go_up=function(i){var t=i.coords().grid,s=t.row,e=s-1,o=!0;return 1!==s&&(this.for_each_column_occupied(t,function(i){if(this.is_occupied(i,e)||this.is_player(i,e)||this.is_placeholder_in(i,e)||this.is_player_in(i,e))return o=!1,!0}),o)},n.can_move_to=function(i,t,s){var e=i.el,o={size_y:i.size_y,size_x:i.size_x,col:t,row:s},r=!0;if(this.options.max_cols!==1/0&&t+i.size_x-1>this.cols)return!1;return!(this.options.max_rows<s+i.size_y-1)&&(this.for_each_cell_occupied(o,function(t,s){var o=this.is_widget(t,s);!o||i.el&&!o.is(e)||(r=!1)}),r)},n.get_targeted_columns=function(i){for(var t=(i||this.player_grid_data.col)+(this.player_grid_data.size_x-1),s=[],e=i;e<=t;e++)s.push(e);return s},n.get_targeted_rows=function(i){for(var t=(i||this.player_grid_data.row)+(this.player_grid_data.size_y-1),s=[],e=i;e<=t;e++)s.push(e);return s},n.get_cells_occupied=function(t){var s,e={cols:[],rows:[]};for(arguments[1]instanceof i&&(t=arguments[1].coords().grid),s=0;s<t.size_x;s++){var o=t.col+s;e.cols.push(o)}for(s=0;s<t.size_y;s++){var r=t.row+s;e.rows.push(r)}return e},n.for_each_cell_occupied=function(i,t){return this.for_each_column_occupied(i,function(s){this.for_each_row_occupied(i,function(i){t.call(this,s,i)})}),this},n.for_each_column_occupied=function(i,t){for(var s=0;s<i.size_x;s++){var e=i.col+s;t.call(this,e,i)}},n.for_each_row_occupied=function(i,t){for(var s=0;s<i.size_y;s++){var e=i.row+s;t.call(this,e,i)}},n.clean_up_changed=function(){var t=this;t.$changed.each(function(){t.options.shift_larger_widgets_down&&t.move_widget_up(i(this))})},n._traversing_widgets=function(t,s,e,o,r){var a=this.gridmap;if(a[e]){var n,_,h=t+"/"+s;if(arguments[2]instanceof i){var d=arguments[2].coords().grid;e=d.col,o=d.row,r=arguments[3]}var l=[],c=o,p={"for_each/above":function(){for(;c--&&!(c>0&&this.is_widget(e,c)&&-1===i.inArray(a[e][c],l)&&(n=r.call(a[e][c],e,c),l.push(a[e][c]),n)););},"for_each/below":function(){for(c=o+1,_=a[e].length;c<_;c++)this.is_widget(e,c)&&-1===i.inArray(a[e][c],l)&&(n=r.call(a[e][c],e,c),l.push(a[e][c]))}};p[h]&&p[h].call(this)}},n.for_each_widget_above=function(i,t,s){return this._traversing_widgets("for_each","above",i,t,s),this},n.for_each_widget_below=function(i,t,s){return this._traversing_widgets("for_each","below",i,t,s),this},n.get_highest_occupied_cell=function(){for(var i,t=this.gridmap,s=t[1].length,e=[],o=[],r=t.length-1;r>=1;r--)for(i=s-1;i>=1;i--)if(this.is_widget(r,i)){e.push(i),o.push(r);break}return{col:Math.max.apply(Math,o),row:Math.max.apply(Math,e)}},n.get_widgets_in_range=function(t,s,e,o){var r,a,n,_,h=i([]);for(r=e;r>=t;r--)for(a=o;a>=s;a--)!1!==(n=this.is_widget(r,a))&&(_=n.data("coords").grid).col>=t&&_.col<=e&&_.row>=s&&_.row<=o&&(h=h.add(n));return h},n.get_widgets_at_cell=function(i,t){return this.get_widgets_in_range(i,t,i,t)},n.get_widgets_from=function(t,s){var e=i();return t&&(e=e.add(this.$widgets.filter(function(){var s=parseInt(i(this).attr("data-col"));return s===t||s>t}))),s&&(e=e.add(this.$widgets.filter(function(){var t=parseInt(i(this).attr("data-row"));return t===s||t>s}))),e},n.set_dom_grid_height=function(i){if(void 0===i){var t=this.get_highest_occupied_cell().row;i=(t+1)*this.options.widget_margins[1]+t*this.min_widget_height}return this.container_height=i,this.$el.css("height",this.container_height),this},n.set_dom_grid_width=function(i){void 0===i&&(i=this.get_highest_occupied_cell().col);var t=this.options.max_cols===1/0?this.options.max_cols:this.cols;return i=Math.min(t,Math.max(i,this.options.min_cols)),this.container_width=(i+1)*this.options.widget_margins[0]+i*this.min_widget_width,this.is_responsive()?(this.$el.css({"min-width":"100%","max-width":"100%"}),this):(this.$el.css("width",this.container_width),this)},n.is_responsive=function(){return this.options.autogenerate_stylesheet&&"auto"===this.options.widget_base_dimensions[0]&&this.options.max_cols!==1/0},n.get_responsive_col_width=function(){var i=this.cols||this.options.max_cols;return(this.$el[0].clientWidth-3-(i+1)*this.options.widget_margins[0])/i},n.resize_responsive_layout=function(){return this.min_widget_width=this.get_responsive_col_width(),this.generate_stylesheet(),this.update_widgets_dimensions(),this.drag_api.set_limits(this.cols*this.min_widget_width+(this.cols+1)*this.options.widget_margins[0]),this},n.toggle_collapsed_grid=function(i,t){return i?(this.$widgets.css({"margin-top":t.widget_margins[0],"margin-bottom":t.widget_margins[0],"min-height":t.widget_base_dimensions[1]}),this.$el.addClass("collapsed"),this.resize_api&&this.disable_resize(),this.drag_api&&this.disable()):(this.$widgets.css({"margin-top":"auto","margin-bottom":"auto","min-height":"auto"}),this.$el.removeClass("collapsed"),this.resize_api&&this.enable_resize(),this.drag_api&&this.enable()),this},n.generate_stylesheet=function(t){var s,e="",o=this.is_responsive()&&this.options.responsive_breakpoint&&i(window).width()<this.options.responsive_breakpoint;t||(t={}),t.cols||(t.cols=this.cols),t.rows||(t.rows=this.rows),t.namespace||(t.namespace=this.options.namespace),t.widget_base_dimensions||(t.widget_base_dimensions=this.options.widget_base_dimensions),t.widget_margins||(t.widget_margins=this.options.widget_margins),this.is_responsive()&&(t.widget_base_dimensions=[this.get_responsive_col_width(),t.widget_base_dimensions[1]],this.toggle_collapsed_grid(o,t));var a=i.param(t);if(i.inArray(a,r.generated_stylesheets)>=0)return!1;for(this.generated_stylesheets.push(a),r.generated_stylesheets.push(a),s=1;s<=t.cols+1;s++)e+=t.namespace+' [data-col="'+s+'"] { left:'+(o?this.options.widget_margins[0]:s*t.widget_margins[0]+(s-1)*t.widget_base_dimensions[0])+"px; }\n";for(s=1;s<=t.rows+1;s++)e+=t.namespace+' [data-row="'+s+'"] { top:'+(s*t.widget_margins[1]+(s-1)*t.widget_base_dimensions[1])+"px; }\n";for(var n=1;n<=t.rows;n++)e+=t.namespace+' [data-sizey="'+n+'"] { height:'+(o?"auto":n*t.widget_base_dimensions[1]+(n-1)*t.widget_margins[1])+(o?"":"px")+"; }\n";for(var _=1;_<=t.cols;_++){var h=_*t.widget_base_dimensions[0]+(_-1)*t.widget_margins[0];e+=t.namespace+' [data-sizex="'+_+'"] { width:'+(o?this.$wrapper.width()-2*this.options.widget_margins[0]:h>this.$wrapper.width()?this.$wrapper.width():h)+"px; }\n"}return this.remove_style_tags(),this.add_style_tag(e)},n.add_style_tag=function(i){var t=document,s="gridster-stylesheet";if(""!==this.options.namespace&&(s=s+"-"+this.options.namespace),!document.getElementById(s)){var e=t.createElement("style");e.id=s,t.getElementsByTagName("head")[0].appendChild(e),e.setAttribute("type","text/css"),e.styleSheet?e.styleSheet.cssText=i:e.appendChild(document.createTextNode(i)),this.remove_style_tags(),this.$style_tags=this.$style_tags.add(e)}return this},n.remove_style_tags=function(){var t=r.generated_stylesheets,s=this.generated_stylesheets;this.$style_tags.remove(),r.generated_stylesheets=i.map(t,function(t){if(-1===i.inArray(t,s))return t})},n.generate_faux_grid=function(i,t){var s,e;for(this.faux_grid=[],this.gridmap=[],s=t;s>0;s--)for(this.gridmap[s]=[],e=i;e>0;e--)this.add_faux_cell(e,s);return this},n.add_faux_cell=function(t,s){var e=i({left:this.baseX+(s-1)*this.min_widget_width,top:this.baseY+(t-1)*this.min_widget_height,width:this.min_widget_width,height:this.min_widget_height,col:s,row:t,original_col:s,original_row:t}).coords();return i.isArray(this.gridmap[s])||(this.gridmap[s]=[]),void 0===this.gridmap[s][t]&&(this.gridmap[s][t]=!1),this.faux_grid.push(e),this},n.add_faux_rows=function(i){i=window.parseInt(i,10);for(var t=this.rows,s=t+parseInt(i||1),e=s;e>t;e--)for(var o=this.cols;o>=1;o--)this.add_faux_cell(e,o);return this.rows=s,this.options.autogenerate_stylesheet&&this.generate_stylesheet(),this},n.add_faux_cols=function(i){i=window.parseInt(i,10);var t=this.cols,s=t+parseInt(i||1);s=Math.min(s,this.options.max_cols);for(var e=t+1;e<=s;e++)for(var o=this.rows;o>=1;o--)this.add_faux_cell(o,e);return this.cols=s,this.options.autogenerate_stylesheet&&this.generate_stylesheet(),this},n.recalculate_faux_grid=function(){var t=this.$wrapper.width();return this.baseX=(e.width()-t)/2,this.baseY=this.$wrapper.offset().top,"relative"===this.$wrapper.css("position")&&(this.baseX=this.baseY=0),i.each(this.faux_grid,i.proxy(function(i,t){this.faux_grid[i]=t.update({left:this.baseX+(t.data.col-1)*this.min_widget_width,top:this.baseY+(t.data.row-1)*this.min_widget_height})},this)),this.is_responsive()&&this.resize_responsive_layout(),this.options.center_widgets&&this.center_widgets(),this},n.resize_widget_dimensions=function(t){return t.widget_margins&&(this.options.widget_margins=t.widget_margins),t.widget_base_dimensions&&(this.options.widget_base_dimensions=t.widget_base_dimensions),this.min_widget_width=2*this.options.widget_margins[0]+this.options.widget_base_dimensions[0],this.min_widget_height=2*this.options.widget_margins[1]+this.options.widget_base_dimensions[1],this.$widgets.each(i.proxy(function(t,s){var e=i(s);this.resize_widget(e)},this)),this.generate_grid_and_stylesheet(),this.get_widgets_from_DOM(),this.set_dom_grid_height(),this.set_dom_grid_width(),this},n.get_widgets_from_DOM=function(){var t=this.$widgets.map(i.proxy(function(t,s){var e=i(s);return this.dom_to_coords(e)},this));return t=r.sort_by_row_and_col_asc(t),i(t).map(i.proxy(function(i,t){return this.register_widget(t)||null},this)).length&&this.$el.trigger("gridster:positionschanged"),this},n.get_num_widgets=function(){return this.$widgets.size()},n.set_num_columns=function(t){var s=this.options.max_cols,e=Math.floor(t/(this.min_widget_width+this.options.widget_margins[0]))+this.options.extra_cols,o=this.$widgets.map(function(){return i(this).attr("data-col")}).get();o.length||(o=[0]);var r=Math.max.apply(Math,o);this.cols=Math.max(r,e,this.options.min_cols),s!==1/0&&s>=r&&s<this.cols&&(this.cols=s),this.drag_api&&this.drag_api.set_limits(this.cols*this.min_widget_width+(this.cols+1)*this.options.widget_margins[0])},n.set_new_num_rows=function(t){var s=this.options.max_rows,e=this.$widgets.map(function(){return i(this).attr("data-row")}).get();e.length||(e=[0]);var o=Math.max.apply(Math,e);this.rows=Math.max(o,t,this.options.min_rows),s!==1/0&&(s<o||s<this.rows)&&(s=this.rows),this.min_rows=o,this.max_rows=s,this.options.max_rows=s;var r=this.rows*this.min_widget_height+(this.rows+1)*this.options.widget_margins[1];this.drag_api&&(this.drag_api.options.container_height=r),this.container_height=r,this.generate_faux_grid(this.rows,this.cols)},n.generate_grid_and_stylesheet=function(){var t=this.$wrapper.width();this.set_num_columns(t);this.options.extra_rows;return this.$widgets.each(function(t,s){+i(s).attr("data-sizey")}),this.rows=this.options.max_rows,this.baseX=(e.width()-t)/2,this.baseY=this.$wrapper.offset().top,this.options.autogenerate_stylesheet&&this.generate_stylesheet(),this.generate_faux_grid(this.rows,this.cols)},n.destroy=function(t){return this.$el.removeData("gridster"),i.each(this.$widgets,function(){i(this).removeData("coords")}),e.unbind(".gridster"),this.drag_api&&this.drag_api.destroy(),this.resize_api&&this.resize_api.destroy(),this.$widgets.each(function(t,s){i(s).coords().destroy()}),this.resize_api&&this.resize_api.destroy(),this.remove_style_tags(),t&&this.$el.remove(),this},i.fn.gridster=function(t){return this.each(function(){var s=i(this);s.data("gridster")||s.data("gridster",new r(this,t))})},r});